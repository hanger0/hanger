<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE sqlMap PUBLIC "-//iBATIS.com//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd">
<sqlMap namespace="Data">
	<typeAlias alias="reply" type="com.hanger.reply.vo.ReplyVo"/>
	<typeAlias alias="user" type="com.hanger.user.vo.UserVo"/>
	
	<insert id="insertReply" parameterClass="reply">
		INSERT INTO REPLY(REPLY_CODE, USER_CODE, POSTING_CODE, REPLY_CONTENT, REG_ID, REG_DATE, REG_IP, UPD_ID, UPD_DATE, UPD_IP)
		VALUES(CONCAT("RE",LPAD((SELECT GET_SEQ('REPLY_CODE')), 10, '0')), #userCode#, #postingCode#, #replyContent#, #regId#, SYSDATE(), #regIp#, #updId#, SYSDATE(), #updIp#)
	</insert>
	
	<select id="selectReply" parameterClass="HashMap" resultClass="reply">
		SELECT B.USER_NAME AS userName, A.REPLY_CONTENT AS replyContent, A.REG_ID AS regId, A.REG_DATE AS reg_date, A.REG_ID AS regIp, A.UPD_ID AS updId, A.UPD_DATE AS updDate, A.UPD_IP AS updIp, B.USER_PIC_PATH as userPicPath, B.USER_PIC_SAVE_NAME AS userPicSaveName
		FROM reply A, user B
		WHERE REPLY_USE_YN != 'N' AND A.USER_CODE = B.USER_CODE AND A.POSTING_CODE = #postingCodeList#
	</select>
	
	<update id="updateReply" parameterClass="user">
		update user set USER_PWD = #userPwd#, USER_NAME = #userName#, USER_PHONE = #userPhone#, USER_QUESTION = #userQuestion#, USER_ANSWER = #userAnswer#, USER_ADDR1 = #userAddr1#, USER_ADDR2 = #userAddr2#, USER_POSTCODE1 = #userPostCode1#, USER_POSTCODE2 = #userPostCode2#, USER_PIC_PATH = #userPicPath#, USER_PIC_ORG_NAME = #userPicOrgName#, USER_PIC_SAVE_NAME = #userPicSaveName#, USER_SKINTYPE = #userSkinType#, USER_SKINTONE = #userSkinTone#, USER_SKINPROBLEM = #userSkinProblem#, upd_id = #updId#, UPD_DATE = #updDate#, UPD_IP = #updIp#
		where USER_ID = #userId#
	</update>
	
</sqlMap>
